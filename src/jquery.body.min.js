/*!
* jQuery Body Plugin v0.1
* https://github.com/madc/jquery.body.js
*
* Released under the MIT license <http://opensource.org/licenses/MIT>
*/

(function(e,t){"use strict";function i(t,i){this.element=t;this.settings=e.extend({},r,i);this._defaults=r;this._name=n}var n="body",r={rows:10,cols:20,rowClass:"row",padding:2,tileClass:"tile",tileSize:[300,300],tileFolder:"images/tiles/",fallbackClass:"fallback",fallbackFolder:"images/fallback/",startTile:false};var i=function(t){this.settings=e.extend({},r)};i.prototype={init:function(n){e.extend(this.settings,n);var r=this.settings.cols*(this.settings.tileSize[0]+this.settings.padding);for(var i=1;i<=this.settings.rows;i++){var o=e("<div/>",{"class":this.settings.rowClass,width:r}).appendTo(this.element);for(var u=1;u<=this.settings.cols;u++){var a=e("<div/>",{"class":this.settings.tileClass,width:this.settings.tileSize[0],height:this.settings.tileSize[1],"data-row":i,"data-column":u}).appendTo(o)}}if(this.settings.startTile){this.scrollToTile(this.settings.startTile[0],this.settings.startTile[1])}var f=this;e(t).on("DOMContentLoaded load resize scroll",function(){e("."+f.settings.tileClass).each(function(){var t=e(this);if(s(t)&&t.children().length==0){var n=t.data("row"),r=t.data("column");f.preloadTile(n,r).appendTo(t)}})})},preloadTile:function(t,n){var r=this.settings;return e("<img/>",{src:this.settings.tileFolder+t+"x"+n+".jpg",error:function(){e(this).attr("src",r.fallbackFolder+t+"x"+n+".jpg").addClass(r.fallbackClass)},load:function(){e(this).fadeIn(1e3)}}).hide()},scrollToTile:function(n,r,i,s,o){var u=e('.tile[data-row="'+n+'"][data-column="'+r+'"]'),a=u.offset().top,f=u.offset().left;if(s===true){a-=e(t).height()/2-this.settings.tileSize[1]/2,f-=e(t).width()/2-this.settings.tileSize[0]/2}if(e.isNumeric(i)){e("html, body").animate({scrollTop:a,scrollLeft:f},i,function(){e.isFunction(o)&&o.call(this,u)})}else{e("html, body").scrollTop(a).scrollLeft(f);e.isFunction(o)&&o.call(this,u)}}};var s=function(n){var r=e(t);var i={top:r.scrollTop(),left:r.scrollLeft()};i.right=i.left+r.width();i.bottom=i.top+r.height();var s=n.offset();s.right=s.left+n.outerWidth();s.bottom=s.top+n.outerHeight();return!(i.right<s.left||i.left>s.right||i.bottom<s.top||i.top>s.bottom)};e.fn[n]=function(t){var r,s;if(!(this.data("plugin_"+n)instanceof i)){this.data("plugin_"+n,new i(this))}s=this.data("plugin_"+n);s.element=this;if(typeof t==="undefined"||typeof t==="object"){if(typeof s["init"]==="function"){s.init(t)}}else if(typeof t==="string"&&typeof s[t]==="function"){r=Array.prototype.slice.call(arguments,1);return s[t].apply(s,r)}else{e.error("Method "+t+" does not exist on jQuery."+n)}}})(jQuery,window)